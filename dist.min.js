const c=document.getElementById("c"),ctx=c.getContext("2d");c.width=800,c.height=400;let keys={};onkeydown=t=>keys[t.key]=!0,onkeyup=t=>keys[t.key]=!1;let gameOver=!1,day=!0,timer=1e4,dayLength=1e4,nightLength=2e4,player={x:200,y:300,w:20,h:20,vy:0,onGround:!1},catHeight=c.height/4,cat={x:0,y:250,w:catHeight,h:catHeight,speed:1,vy:0},gravity=.5,camX=0,blocks=[{x:0,y:350,w:2e4,h:50},{x:300,y:300,w:100,h:20},{x:500,y:250,w:100,h:20},{x:800,y:300,w:150,h:20},{x:1200,y:300,w:100,h:20},{x:2200,y:250,w:50,h:20},{x:2200,y:250,w:150,h:20}],blinking=!1,blinkCooldown=1e3+2e3*Math.random(),blinkDuration=0,lastTime=0;function loop(){requestAnimationFrame(loop),timer-=16,timer<=0&&(day=!day,timer=day?dayLength:nightLength),keys.ArrowRight&&(player.x+=2),keys.ArrowLeft&&(player.x-=2),keys[" "]&&player.onGround&&(player.vy=-8,player.onGround=!1),player.vy+=gravity,player.y+=player.vy,player.onGround=!1;for(let t of blocks)player.x<t.x+t.w&&player.x+player.w>t.x&&player.y<t.y+t.h&&player.y+player.h>t.y&&player.vy>0&&(player.y=t.y-player.h,player.vy=0,player.onGround=!0);day||(cat.x+=cat.speed),camX=player.x-c.width/2,camX<0&&(camX=0),ctx.fillStyle=day?"#88d":"#000",ctx.fillRect(0,0,c.width,c.height),ctx.fillStyle=day?"#8B4513":"#303030ff";for(let t of blocks)ctx.fillRect(t.x-camX,t.y,t.w,t.h);if(day?(blinking=!1,blinkDuration=0):blinking?(blinkDuration-=30,blinkDuration<=0&&(blinking=!1,blinkCooldown=1500+2e3*Math.random())):(blinkCooldown-=10,blinkCooldown<=0&&(blinking=!0,blinkDuration=180)),ctx.fillStyle="lime",ctx.fillRect(player.x-camX,player.y,player.w,player.h),day)ctx.fillStyle="black",ctx.fillRect(cat.x-camX,cat.y,cat.w,cat.h),ctx.fillStyle="white",ctx.font="16px sans-serif",ctx.fillText("Zzz",cat.x-camX,cat.y-10);else if(ctx.fillStyle="black",ctx.fillRect(cat.x-camX,cat.y,cat.w,cat.h),!blinking){let t=cat.y+cat.h/2-20,l=cat.x-camX+.3*cat.w,e=cat.x-camX+.7*cat.w,a=.2*cat.h,c=.4*a;ctx.fillStyle="yellow",ctx.beginPath(),ctx.arc(l,t,a,0,2*Math.PI),ctx.arc(e,t,a,0,2*Math.PI),ctx.fill(),ctx.fillStyle="black",ctx.beginPath(),ctx.arc(l,t,c,0,2*Math.PI),ctx.arc(e,t,c,0,2*Math.PI),ctx.fill()}ctx.fillStyle="white",ctx.font="14px sans-serif",ctx.fillText(day?"DAY":"NIGHT",10,20),ctx.fillText("Timer: "+Math.ceil(timer/1e3),10,40),day||gameOver||player.x<cat.x+cat.w&&player.x+player.w>cat.x&&player.y<cat.y+cat.h&&player.y+player.h>cat.y&&(gameOver=!0),gameOver&&(ctx.fillStyle="rgba(0,0,0,0.7)",ctx.fillRect(0,0,c.width,c.height),ctx.fillStyle="red",ctx.font="30px sans-serif",ctx.fillText("GAME OVER",c.width/2-80,c.height/2),ctx.fillStyle="white",ctx.font="16px sans-serif",ctx.fillText("Tryck F5 f√∂r att starta om",c.width/2-100,c.height/2+30));let t=Math.min(player.x/5e3,1),l=Math.min(cat.x/5e3,1);ctx.fillStyle="#333",ctx.fillRect(20,20,c.width-40,10),ctx.fillStyle="lime",ctx.fillRect(20,20,(c.width-40)*t,10),ctx.fillStyle="red",ctx.fillRect(20,20,(c.width-40)*l,10),ctx.strokeStyle="white",ctx.strokeRect(20,20,c.width-40,10)}loop();